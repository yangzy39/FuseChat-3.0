<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description" content="FuseChat-3.0: Preference Optimization for Implicit Model Fusion">
  <meta property="og:title" content="FuseChat-3.0: Preference Optimization for Implicit Model Fusion"/>
  <meta property="og:description" content="FuseChat-3.0 introduces implicit model fusion (IMF) with preference optimization to transfer capabilities of source models into target models."/>
  <meta property="og:url" content="URL OF THE WEBSITE"/>
  <meta property="og:image" content="static/images/your_banner_image.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>
  <meta name="twitter:title" content="FuseChat-3.0: Preference Optimization for Implicit Model Fusion">
  <meta name="twitter:description" content="FuseChat-3.0 introduces implicit model fusion (IMF) with preference optimization to transfer capabilities of source models into target models.">
  <meta name="twitter:image" content="static/images/your_twitter_banner_image.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="keywords" content="FuseChat-3.0, Implicit Model Fusion, Preference Optimization, LLMs, SFT, DPO">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>FuseChat-3.0: Preference Optimization for Implicit Model Fusion</title>
  <link rel="icon" type="image/x-icon" href="static/images/fuseai.jpg">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">
  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>
</head>
<body>

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">FuseChat-3.0: Preference Optimization for Implicit Model Fusion</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://github.com/yangzy39" target="_blank">Ziyi Yang</a><sup>*</sup>,
            </span>
            <span class="author-block">
              <a href="https://fanqiwan.github.io/" target="_blank">Fanqi Wan</a><sup>*</sup>,
            </span>
            <span class="author-block">
              <a href="https://github.com/MrGGLS" target="_blank">Longguang Zhong</a><sup>*</sup>,
            </span>
            <span class="author-block">
              Canbin Huang,
            </span>
             <span class="author-block">
              Guosheng Liang,
            </span>
            <span class="author-block">
              <a href="https://sites.google.com/site/xiaojunquan" target="_blank">Xiaojun Quan</a><sup>â€ </sup>
            </span>
          </div>
          <div class="is-size-5 publication-authors">
            <span class="author-block">School of Computer Science and Engineering, Sun Yat-sen University, China</span>
            <span class="eql-cntrb"><small><br><sup>*</sup>Main Contributors <sup>â€ </sup>Corresponding Author</small></span>
          </div>
          <div class="column has-text-centered">
            <div class="publication-links">
              <span class="link-block">
                <a href="https://huggingface.co/FuseAI" target="_blank" class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">ðŸ¤—</span>
                  <span>Hugging Face</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://github.com/SLIT-AI/FuseChat-3.0" target="_blank" class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2412.03187" target="_blank" class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- </div>
  <section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-four-fifths">
        <div class="content has-text-centered">
          <img src="static/images/FuseChat-3.0.png" width=80%/>
        </div>
      </div>
    </div>
  </div> -->

<!-- Paper abstract -->
<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <div align="center">
        <img src="static/images/FuseChat-3.0.png" width=70%/>
      </div>
      
      <p>
        In this blog post, we present FuseChat-3.0, a series of models crafted to enhance performance by integrating the strengths of multiple source LLMs into more compact target LLMs. To achieve this fusion, we utilized four powerful source LLMs: Gemma-2-27B-It, Mistral-Large-Instruct-2407, Qwen-2.5-72B-Instruct, and Llama-3.1-70B-Instruct. For the target LLMs, we employed three widely-used smaller modelsâ€”Llama-3.1-8B-Instruct, Gemma-2-9B-It, and Qwen-2.5-7B-Instructâ€”along with two even more compact modelsâ€”Llama-3.2-3B-Instruct and Llama-3.2-1B-Instruct. The implicit model fusion process involves a two-stage training pipeline comprising Supervised Fine-Tuning (SFT) to mitigate distribution discrepancies between target and source LLMs, and Direct Preference Optimization (DPO) for learning preferences from multiple source LLMs. The resulting FuseChat-3.0 models demonstrated substantial improvements in tasks related to general conversation, instruction following, mathematics, and coding. Notably, when Llama-3.1-8B-Instruct served as the target LLM, our fusion approach achieved an average improvement of 6.8 points across 14 benchmarks. Moreover, it showed significant improvements of 37.1 and 30.1 points on instruction-following test sets AlpacaEval-2 and Arena-Hard respectively. We have released the <a href="https://huggingface.co/FuseAI" target="_blank">FuseChat-3.0</a> models and datasets on Huggingface.
      </p>
    </div>
  </div>
</section>
<!-- End paper abstract -->
  
<!-- Paper overview -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Overview</h2>
        <div class="content has-text-justified">
        <p>
          Combining the strengths of multiple large language models (LLMs) represents a promising approach to enhance individual model capabilities. Model fusion is a technique that integrates the strengths of robust source LLMs into a target LLM.
        </p>
        
        <p>
          Previous iterations of the <a href="https://arxiv.org/abs/2408.07990">FuseChat</a> series employed probabilistic distribution matrices generated by source models to transfer knowledge to target models. We refer to this method as <strong>explicit model fusion (EMF)</strong> because it involves a well-defined knowledge transfer process. While applicable to models with varying architectures and sizes, and without increasing memory overhead during inference, this approach presents notable challenges such as vocabulary alignment and the merging of distribution matrices from different LLMs. These issues complicate model fusion, reduce its efficiency, and may introduce noise and errors and affect the fusion results.
        </p>
        
        <p>
          FuseChat-3.0, however, takes a different approach by enhancing a single LLM through implicit learning from robust open-source LLMs, a process we term <strong>implicit model fusion (IMF)</strong>. The concept of IMF has been widely utilized to improve the performance of weaker models. For instance, a weak model can be boosted through fine-tuning with outputs from stronger LLMs. Moreover, a reward model can be trained using outputs from various LLMs, enabling it to learn and capture the differences in capabilities between the LLMs. Zephyr further collects responses from multiple LLMs and ranks them with GPT-4 to obtain preference data for training the policy. Inspired by recent alignment techniques, we propose an IMF method to transfer the capabilities of source LLMs to a target LLM through preference optimization.
        </p>
        
        <p>
          Our IMF method follows a three-stage process aimed at effectively transferring capabilities from source LLMs to a target LLM. First, during <strong>dataset construction</strong>, we sample N responses from each of the source LLMs and annotate these responses using an external reward model. Second, in the <strong>supervised fine-tuning (SFT)</strong> stage, we fine-tune the target model using the best responses, which not only enhances the target model's capabilities but also helps mitigate the distributional gap between the source and target models. Finally, in the <strong>direct preference optimization (DPO)</strong> stage, we optimize the target model by using the best and worst responses from the source models as preference pairs, further enhancing the target model's performance. The complete pipeline will be detailed in the following paragraph.
        </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper overview -->

<!-- Dataset Construction -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Dataset</h2>
        <div class="content has-text-justified">
          <h3 class="title is-4">Prompt Selection</h3>
          <p>
            Our datasets were designed to enhance model's instruction following, general conversation, mathematics, coding, and Chinese-language capabilities. We selected data from open-source community datasets, applying targeted filtering and preprocessing. Key datasets and filtering criteria included:
          </p>
          <ul>
            <li><strong>Instruction Following & General Conversation</strong>: Sourced from <a href="https://huggingface.co/datasets/openbmb/UltraFeedback">UltraFeedback</a>, <a href="https://huggingface.co/datasets/Magpie-Align/Magpie-Pro-DPO-100K-v0.1" target="_blank">Magpie-Pro-DPO-100K-v0.1</a>, and <a href="https://huggingface.co/datasets/nvidia/HelpSteer2" target="_blank">HelpSteer2</a>, excluding code and math data.</li>
            <li><strong>Mathematics</strong>: Selected from <a href="https://huggingface.co/datasets/nvidia/OpenMathInstruct-2" target="_blank">OpenMathInstruct-2</a>, with nearly 52,000 unique samples.</li>
            <li><strong>Coding</strong>: Curated from <a href="https://huggingface.co/datasets/greengerong/leetcode" target="_blank">leetcode</a> and <a href="https://huggingface.co/datasets/bigcode/self-oss-instruct-sc2-exec-filter-50k" target="_blank">self-oss-instruct-sc2-exec-filter-50k</a>, retaining prompts with test cases.</li>
            <li><strong>Chinese Language</strong>: Integrated <a href="https://huggingface.co/datasets/llamafactory/alpaca_gpt4_zh" target="_blank">alpaca_gpt4_zh</a> and <a href="https://huggingface.co/datasets/Magpie-Align/Magpie-Qwen2-Pro-200K-Chinese" target="_blank">Magpie-Qwen2-Pro-200K-Chinese</a>, filtering out code and math prompts to retain approximately 10,000 high-quality samples.</li>
          </ul>

          <h3 class="title is-4">Response Sampling</h3>
          <p>
            For each dataset's prompts, we synthesized responses mainly from four different series of source models, specifically <a href="https://huggingface.co/google/gemma-2-27b-it" target="_blank">Gemma-2-27b-It</a>, <a href="https://huggingface.co/mistralai/Mistral-Large-Instruct-2407" target="_blank">Mistral-Large-Instruct-2407</a>, <a href="https://huggingface.co/Qwen/Qwen2-72B-Instruct" target="_blank">Qwen-2.5-72B-Instruct</a>, and <a href="https://huggingface.co/meta-llama/Llama-3.1-70B-Instruct" target="_blank">Llama-3.1-70B-Instruct</a>. Compared to the original approach in <a href="https://arxiv.org/abs/2412.03187" target="_blank">WRPO</a> using up to ten source LLMs, this streamlined selection ensures both representativeness and accessibility of the experiments.
          </p>
          <ul>
            <li><strong>Instruction Following & General Conversation</strong>: We sampled each prompt five times from all the source models.</li>
            <li><strong>Mathematics</strong>: We retained the responses generated by Llama-3.1-405B-Instruct from the original dataset (OpenMathInstruct-2) and additionally sampled responses using <a href="https://huggingface.co/Qwen/Qwen-2.5-Math-72B-Instruct" target="_blank">Qwen-2.5-Math-72B-Instruct</a>.</li>
            <li><strong>Coding</strong>: We sampled each prompt eight times for all source models.</li>
            <li><strong>Chinese Language</strong>: We included single response sampled exclusively from Qwen-2.5-72B-Instruct.</li>
          </ul>
          <p>
            The sampling parameters for different models are detailed in Table below.
          </p>
          
          <table class="js-sort-table table hidden">
            <tr>
              <td class="js-sort-string"><strong>Source LLMs</strong></td>
              <td class="js-sort-string"><strong>Sampling Params</strong></td>
            </tr>

            <tr>
              <td>Gemma-2-27b-It</td>
              <td>Temp 0.8 Top-p 0.95</td>
            </tr>
            
            <tr>
              <td>Mistral-Large-Instruct-2407</td>
              <td>Temp 0.8 Top-p 0.95</td>
            </tr>
            
            <tr>
              <td>Qwen-2.5-(Math)-72B-Instruct</td>
              <td>Temp 0.7 Top-p 0.8 Repetition penalty 1.05</td>
            </tr>
            
            <tr>
              <td>Llama-3.1-70B-Instruct</td>
              <td>Temp 0.8 Top-p 0.95</td>
            </tr>
            

          </table>

          <h3 class="title is-4">Data Construction</h3>
          <p>
            Unlike the original approach in <a href="https://arxiv.org/abs/2412.03187" target="_blank">WRPO</a>, which constructs preference pairs from target model responses and treats source model responses as additional positive samples, our research in mathematics and coding domains revealed that sampling from multiple source models yields more and higher-quality preference pair data. Based on this insight, FuseChat-3.0 leverages the best and worst response pairs generated by source models as preference pairs to optimize the target model. This refined approach not only preserves the core advantages of implicit model fusion but also results in a more streamlined and practical implementation, making it particularly well-suited for real-world applications within the open-source community.
          </p>
          <p>
            <strong>Instruction Following</strong>: To assign RM scores to the five responses generated by each source model, we employed <a href="https://huggingface.co/RLHFlow/ArmoRM-Llama3-8B-v0.1" target="_blank">ArmoRM</a> for annotation. We then divided the annotated data into SFT and DPO datasets using a 4:6 ratio. For the SFT phase, we selected the responses with the highest RM scores. During the DPO phase, we paired responses from the same source model, designating those with the highest RM scores as positive samples and those with the lowest RM scores as negative samples. We ensured that the RM score difference between the positive and negative samples in each pair ranged from 0.01 to 0.1.
          </p>
          <p>
            <strong>Mathematics</strong>: We initially annotated the responses from all source models for correctness by comparing them with the gold labels and evaluating them using the RM scores provided by ArmoRM. We then strategically divided the dataset into SFT phase and DPO phase. In the SFT phase, we incorporated responses that were correct and had the highest RM scores. This selection ensured that the fine-tuning process was based on high-quality responses that aligned closely with the desired outcomes. For the DPO phase, we constructed paired samples from the same source model. The positive samples consisted of correct answers with the highest RM scores, while the negative samples were incorrect answers with the lowest RM scores. To ensure meaningful comparisons during optimization, we maintained an RM score differential between positive and negative pairs within the range of 0.01 to 0.1.
          </p>
          <p>
            <strong>Coding</strong>: We employed a dual-scoring system comprising correctness scores and RM scores for coding evaluation. The correctness scores assessed whether the code passed both static analysis and test cases, ensuring functional accuracy. The RM scores were used for preference evaluation, gauging the quality of responses based on predefined criteria. During the SFT phase, we included responses that not only passed all test cases but also achieved the highest RM scores. This selection ensured that the model was fine-tuned on exemplary code that met both correctness and preference standards. In the DPO phase, we contrasted positive samplesâ€”high-scoring responses that passed the testsâ€”with negative samplesâ€”low-scoring responses that failed the tests. This comparison aimed to optimize the model's ability to prefer higher-quality code during training. We excluded any instances where all model responses failed to meet the testing criteria. This exclusion was necessary to maintain the integrity of the evaluation process, as such cases did not provide meaningful data for assessing and improving the model's performance.
          </p>
          <p>
            <strong>Chinese</strong>: We exclusively utilized responses sampled from Qwen-2.5-72B-Instruct during the SFT phase, due to its strong performance in the Chinese language.
          </p>

          <p>
            Our final dataset comprised 158,667 total entries, with 94,539 entries for the SFT phase and 64,128 preference pairs for the DPO phase. The overall composition of the datasets is shown below.
          </p>
          <table class="js-sort-table table hidden">
            <tr>
              <td class="js-sort-string"><strong>Dataset</strong></td>
              <td class="js-sort-number"><strong>Total Count</strong></td>
              <td class="js-sort-number"><strong>SFT Count</strong></td>
              <td class="js-sort-number"><strong>DPO Count</strong></td>
              <td class="js-sort-string"><strong>Category</strong></td>
            </tr>
          
            <tr>
              <td><a href="https://huggingface.co/datasets/openbmb/UltraFeedback" target="_blank">UltraFeedback</a></td>
              <td>51098</td>
              <td>20439</td>
              <td>30659</td>
              <td>Instruction following</td>
            </tr>
          
            <tr>
              <td><a href="https://huggingface.co/datasets/Magpie-Align/Magpie-Pro-DPO-100K-v0.1" target="_blank">Magpie-Pro-DPO</a></td>
              <td>20374</td>
              <td>8149</td>
              <td>12225</td>
              <td>Instruction following</td>
            </tr>
          
            <tr>
              <td><a href="https://huggingface.co/datasets/nvidia/HelpSteer2" target="_blank">HelpSteer2</a></td>
              <td>9435</td>
              <td>3774</td>
              <td>5661</td>
              <td>Instruction following</td>
            </tr>
          
            <tr>
              <td><a href="https://huggingface.co/datasets/nvidia/OpenMathInstruct-2" target="_blank">OpenMathInstruct-2</a></td>
              <td>51803</td>
              <td>40188</td>
              <td>11615</td>
              <td>Mathematics</td>
            </tr>
          
            <tr>
              <td><a href="https://huggingface.co/datasets/greengerong/leetcode" target="_blank">leetcode</a></td>
              <td>3113</td>
              <td>1877</td>
              <td>1236</td>
              <td>Coding</td>
            </tr>
          
            <tr>
              <td><a href="https://huggingface.co/datasets/bigcode/self-oss-instruct-sc2-exec-filter-50k" target="_blank">self-oss-instruct-sc2</a></td>
              <td>12892</td>
              <td>10160</td>
              <td>2732</td>
              <td>Coding</td>
            </tr>
          
            <tr>
              <td><a href="https://huggingface.co/datasets/llamafactory/alpaca_gpt4_zh" target="_blank">alpaca_gpt4_zh</a></td>
              <td>2471</td>
              <td>2471</td>
              <td>0</td>
              <td>Chinese Language</td>
            </tr>
          
            <tr>
              <td><a href="https://huggingface.co/datasets/Magpie-Align/Magpie-Qwen2-Pro-200K-Chinese" target="_blank">Magpie-Qwen2-Pro</a></td>
              <td>7481</td>
              <td>7481</td>
              <td>0</td>
              <td>Chinese Language</td>
            </tr>
          
            <tr>
              <td><strong>Total</strong></td>
              <td>158667</td>
              <td>94539</td>
              <td>64128</td>
              <td>All</td>
            </tr>

            
          </table>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End Dataset Construction -->

<!-- Training Pipeline -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Training</h2>
        <div class="content has-text-justified">
          <p>
            The implicit model fusion process involves a two-stage training pipeline comprising Supervised Fine-Tuning (SFT) to mitigate distribution discrepancies between target and source LLMs, and Direct Preference Optimization (DPO) for learning preferences from multiple source LLMs.
          </p>

          <h3 class="title is-4">SFT</h3>
          <p>
            We used <a href="https://github.com/hiyouga/LLaMA-Factory" target="_blank">Llama-Factory</a> as our fine-tuning library. For all target models, we fine-tuned for 3 epochs, with a batch size of 128 and a maximum sequence length of 2048 tokens. A cosine learning rate schedule with a warmup ratio of 0.1 is employed. Different models' learning rates are shown in the table below.
          </p>
          <table class="js-sort-table table hidden">
            <tr>
              <td class="js-sort-string"><strong>Target Models</strong></td>
              <td class="js-sort-string"><strong>Learning rate</strong></td>
            </tr>
          
            <tr>
              <td>Llama-3.1-8B-Instruct</td>
              <td>5e-6</td>
            </tr>
          
            <tr>
              <td>Qwen-2.5-7B-Instruct</td>
              <td>2e-6</td>
            </tr>
          
            <tr>
              <td>Gemma-2-9B-It</td>
              <td>2e-6</td>
            </tr>
          
            <tr>
              <td>Llama-3.2-(1/3)B-Instruct</td>
              <td>5e-6</td>
            </tr>

            
          </table>

          <h3 class="title is-4">DPO</h3>
          <p>
            We used <a href="https://github.com/huggingface/alignment-handbook" target="_blank">alignment-handbook</a> as our DPO training library. For all Target SFT models, we trained for 1 epoch with a batch size of 128, set maximum sequence length to 2048, used cosine learning rate with a warmup ratio of 0.1. We saved checkpoints every 100 steps and selected the best from the last two checkpoints. For Llama-3.1 and Llama-3.2 series models, we introduced length normalization in DPO training, as shown in the formula below.
          </p>
          <p>
            <img src="https://latex.codecogs.com/svg.image?\mathcal{L}_{\text{LN-DPO}}=-\log\sigma\left(\frac{\beta}{|y_w|}\log\frac{\pi_\theta(y_w|x)}{\pi_{\text{ref}}(y_w|x)}-\frac{\beta}{|y_l|}\log\frac{\pi_\theta(y_l|x)}{\pi_{\text{ref}}(y_l|x)}\right)" alt="Length Normalized DPO Formula" />
          </p>
          <p>
            Different models' hyperparameters are shown in the table below.
          </p>
         <table class="js-sort-table table hidden">
            <tr>
              <td class="js-sort-string"><strong>Target SFT Models</strong></td>
              <td class="js-sort-string"><strong>Learning rate</strong></td>
              <td class="js-sort-string"><strong>Î²</strong></td>
              <td class="js-sort-string"><strong>Length normalize</strong></td>
            </tr>
          
            <tr>
              <td>FuseChat-Llama-3.1-8B-SFT</td>
              <td>8e-7</td>
              <td>10</td>
              <td>Yes</td>
            </tr>
          
            <tr>
              <td>FuseChat-Qwen-2.5-7B-SFT</td>
              <td>3e-7</td>
              <td>0.01</td>
              <td>No</td>
            </tr>
          
            <tr>
              <td>FuseChat-Gemma-2-9B-SFT</td>
              <td>5e-7</td>
              <td>0.01</td>
              <td>No</td>
            </tr>
          
            <tr>
              <td>FuseChat-Llama-3.2-(1/3)B-SFT</td>
              <td>1e-6</td>
              <td>10</td>
              <td>Yes</td>
            </tr>
          
                     
          </table>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End Training Pipeline -->

<!-- Evaluation -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Evaluation</h2>
        <div class="content has-text-justified">
          <p>
            The evaluation of instruction-tuned models mainly focuses on the model performance of instruction following, natural language understanding, general question answering, reasoning, mathematics, coding, etc. For the evaluation of FuseChat-3.0, we include 14 benchmarks and organize them into four categories:
          </p>
          <ul>
            <li><strong>Instruction Following</strong> Tasks: AlpacaEval-2, Arena-Hard, MTbench, AlignBench v1.1 (Chinese).</li>
            <li><strong>General</strong> Tasks: LiveBench-0831, MMLU-Pro, MMLU-redux, GPQA-Diamond.</li>
            <li><strong>Mathematics</strong> Tasks: GSM8K, MATH, AMC 23.</li>
            <li><strong>Coding</strong> Tasks: HumanEval, MBPP, LiveCodeBench 2408-2411.</li>
          </ul>
          <p>
            We include more details and release our evaluation code at <a href="https://github.com/SLIT-AI/FuseChat-3.0/tree/main/FuseEval" target="_blank">FuseEval</a>.
          </p>
          <p>
            The evaluation results of five series fused models are as follows, showing that our FuseChat-3.0 models achieved varying degrees of improvement across different target models. When selecting Llama-3.1-8B-Instruct as the target model, our fusion model <strong>FuseChat-Llama-3.1-8B-Instruct achieved an average performance improvement of 6.8 points across 14 benchmarks. Notably, it showed significant improvements of 37.1 and 30.1 points on instruction-following test sets AlpacaEval-2 and Arena-Hard respectively</strong>. Additionally, FuseChat-Llama-3.1-8B-Instruct outperformed AllenAI's recently released Llama-3.1-Tulu-3-8B model on all benchmarks except GSM8K and GPQA-Diamond. All these results demonstrate the effectiveness and success of FuseChat-3.0.
          </p>
          <h3 class="title is-4">FuseChat-Llama-3.1-8B-Instruct Performance</h3>
          <table class="js-sort-table table hidden">
            <tr>
              <td class="js-sort-string"><strong>Benchmarks</strong></td>
              <td class="js-sort-string"><strong>Llama-3.1-8B-Instruct</strong></td>
              <td class="js-sort-string"><strong>Llama-3.1-Tulu-3-8B</strong></td>
              <td class="js-sort-string"><strong>FuseChat-Llama-3.1-8B-SFT</strong></td>
              <td class="js-sort-string"><strong>FuseChat-Llama-3.1-8B-Instruct</strong></td>
            </tr>
          
            <tr>
              <td style="white-space: nowrap;">AlpacaEval-2 (LC %)</td>
              <td>28.3</td>
              <td>33.4</td>
              <td>41.3</td>
              <td><strong>65.4</strong></td>
            </tr>
          
            <tr>
              <td>Arena-Hard (WR %)</td>
              <td>28.1</td>
              <td>45.6</td>
              <td>38.7</td>
              <td><strong>58.2</strong></td>
            </tr>
          
            <tr>
              <td>MT-Bench</td>
              <td>8.4</td>
              <td>8.3</td>
              <td>8.5</td>
              <td><strong>9.0</strong></td>
            </tr>
          
            <tr>
              <td>AlignBench v1.1</td>
              <td>4.6</td>
              <td>6.2</td>
              <td>6.3</td>
              <td><strong>6.7</strong></td>
            </tr>
          
            <tr>
              <td>GSM8K</td>
              <td>85.9</td>
              <td><strong>88.6</strong></td>
              <td>87.0</td>
              <td>88.0</td>
            </tr>
          
            <tr>
              <td>MATH</td>
              <td>50.7</td>
              <td>47.5</td>
              <td>54.7</td>
              <td><strong>55.2</strong></td>
            </tr>
          
            <tr>
              <td>AMC 23</td>
              <td>25.0</td>
              <td>25.0</td>
              <td>30.0</td>
              <td><strong>37.5</strong></td>
            </tr>
          
            <tr>
              <td>LiveBench 0831</td>
              <td>27.6</td>
              <td>30.1</td>
              <td>30.2</td>
              <td><strong>32.0</strong></td>
            </tr>
          
            <tr>
              <td>MMLU-Pro</td>
              <td><strong>50.0</strong></td>
              <td>42.9</td>
              <td>47.8</td>
              <td>49.2</td>
            </tr>
          
            <tr>
              <td>MMLU-redux</td>
              <td>67.2</td>
              <td>66.3</td>
              <td>68.4</td>
              <td><strong>69.2</strong></td>
            </tr>
          
            <tr>
              <td>GPQA-Diamond</td>
              <td>33.8</td>
              <td>35.9</td>
              <td><strong>37.9</strong></td>
              <td>34.9</td>
            </tr>
          
            <tr>
              <td>HumanEval</td>
              <td>69.5</td>
              <td>66.5</td>
              <td>69.5</td>
              <td><strong>71.3</strong></td>
            </tr>
          
            <tr>
              <td>MBPP</td>
              <td><strong>75.4</strong></td>
              <td>56.3</td>
              <td>71.4</td>
              <td>72.0</td>
            </tr>
          
            <tr>
              <td>LiveCodeBench<br>2408-2411</td>
              <td>12.3</td>
              <td>10.6</td>
              <td>12.6</td>
              <td><strong>13.1</strong></td>
            </tr>
          
            <tr>
              <td>Average</td>
              <td>40.5</td>
              <td>40.2</td>
              <td>43.2</td>
              <td><strong>47.3</strong></td>
            </tr>
          </table>
        <h3 class="title is-4">FuseChat-Qwen-2.5-7B-Instruct Performance</h3>
        <table class="js-sort-table table hidden">
          <tr>
            <td class="js-sort-string"><strong>Datasets</strong></td>
            <td class="js-sort-string"><strong>Qwen-2.5-7B-Instruct</strong></td>
            <td class="js-sort-string"><strong>FuseChat-Qwen-2.5-7B-SFT</strong></td>
            <td class="js-sort-string"><strong>FuseChat-Qwen-2.5-7B-Instruct</strong></td>
          </tr>
        
          <tr>
            <td style="white-space: nowrap;">AlpacaEval-2 (LC %)</td>
            <td>33.2</td>
            <td>34.2</td>
            <td><strong>63.6</strong></td>
          </tr>
        
          <tr>
            <td>Arena-Hard (WR %)</td>
            <td>50.7</td>
            <td>45.2</td>
            <td><strong>61.4</strong></td>
          </tr>
        
          <tr>
            <td>MT-Bench</td>
            <td>8.4</td>
            <td>8.5</td>
            <td><strong>9.0</strong></td>
          </tr>
        
          <tr>
            <td>AlignBench v1.1</td>
            <td>7.5</td>
            <td>7.4</td>
            <td><strong>7.6</strong></td>
          </tr>
        
          <tr>
            <td>GSM8K</td>
            <td>91.7</td>
            <td><strong>92.3</strong></td>
            <td>91.7</td>
          </tr>
        
          <tr>
            <td>MATH</td>
            <td><strong>75.0</strong></td>
            <td>72.7</td>
            <td>73.6</td>
          </tr>
        
          <tr>
            <td>AMC 23</td>
            <td>52.5</td>
            <td>45.0</td>
            <td><strong>57.5</strong></td>
          </tr>
          
          <tr>
            <td>LiveBench-0831</td>
            <td><strong>35.4</strong></td>
            <td>33.7</td>
            <td>33.2</td>
          </tr>   
          
          <tr>
            <td>MMLU-Pro</td>
            <td><strong>54.1</strong></td>
            <td>51.7</td>
            <td>53.0</td>
          </tr>
        
          <tr>
            <td>MMLU-redux</td>
            <td><strong>75.1</strong></td>
            <td>72.7</td>
            <td>74.4</td>
          </tr>
        
          <tr>
            <td>GPQA-Diamond</td>
            <td>34.9</td>
            <td><strong>38.4</strong></td>
            <td>33.8</td>
          </tr>
        
          <tr>
            <td>HumanEval</td>
            <td><strong>85.4</strong></td>
            <td>81.7</td>
            <td>79.9</td>
          </tr>
        
          <tr>
            <td>MBPP</td>
            <td>80.2</td>
            <td><strong>84.1</strong></td>
            <td>83.1</td>
          </tr>
        
          <tr>
            <td>LiveCodeBench<br>2408-2411</td>
            <td>15.8</td>
            <td>17.3</td>
            <td><strong>18.9</strong></td>
          </tr>
        
          <tr>
            <td>Average</td>
            <td>50.0</td>
            <td>48.9</td>
            <td><strong>52.9</strong></td>
          </tr>
        </table>
        <h3 class="title is-4">FuseChat-Gemma-2-9B-Instruct Performance</h3>
        <table class="js-sort-table table hidden">
          <tr>
            <td class="js-sort-string"><strong>Datasets</strong></td>
            <td class="js-sort-string"><strong>Gemma-2-9B-It</strong></td>
            <td class="js-sort-string"><strong>FuseChat-Gemma-2-9B-SFT</strong></td>
            <td class="js-sort-string"><strong>FuseChat-Gemma-2-9B-Instruct</strong></td>
          </tr>
        
          <tr>
            <td style="white-space: nowrap;">AlpacaEval-2 (LC %)</td>
            <td>51.1</td>
            <td>49.8</td>
            <td><strong>70.2</strong></td>
          </tr>
        
          <tr>
            <td>Arena-Hard (WR %)</td>
            <td>40.8</td>
            <td>44.5</td>
            <td><strong>63.4</strong></td>
          </tr>
        
          <tr>
            <td>MT-Bench</td>
            <td>8.5</td>
            <td><strong>8.7</strong></td>
            <td>8.6</td>
          </tr>
        
          <tr>
            <td>AlignBench v1.1</td>
            <td>7.0</td>
            <td>7.1</td>
            <td><strong>7.4</strong></td>
          </tr>
        
          <tr>
            <td>GSM8K</td>
            <td>88.5</td>
            <td>90.5</td>
            <td><strong>91.0</strong></td>
          </tr>
        
          <tr>
            <td>MATH</td>
            <td>49.6</td>
            <td><strong>58.0</strong></td>
            <td>57.8</td>
          </tr>
        
          <tr>
            <td>AMC 23</td>
            <td>20.0</td>
            <td>27.5</td>
            <td><strong>35.0</strong></td>
          </tr>
        
          <tr>
            <td>LiveBench-0831</td>
            <td>31.6</td>
            <td><strong>33.3</strong></td>
            <td>33.2</td>
          </tr>
          
          <tr>
            <td>MMLU-Pro</td>
            <td>50.5</td>
            <td>52.5</td>
            <td><strong>52.9</strong></td>
          </tr>
        
          <tr>
            <td>MMLU-redux</td>
            <td>72.8</td>
            <td>72.8</td>
            <td><strong>73.7</strong></td>
          </tr>
        
          <tr>
            <td>GPQA-Diamond</td>
            <td><strong>39.4</strong></td>
            <td>33.3</td>
            <td>35.4</td>
          </tr>
        
          <tr>
            <td>HumanEval</td>
            <td><strong>67.1</strong></td>
            <td>65.9</td>
            <td>64.0</td>
          </tr>
        
          <tr>
            <td>MBPP</td>
            <td><strong>75.1</strong></td>
            <td>70.6</td>
            <td>71.7</td>
          </tr>
        
          <tr>
            <td>LiveCodeBench<br>2408-2411</td>
            <td><strong>11.9</strong></td>
            <td>11.0</td>
            <td>10.1</td>
          </tr>
        
          <tr>
            <td>Average</td>
            <td>43.9</td>
            <td>44.7</td>
            <td><strong>48.2</strong></td>
          </tr>
        </table>
        <h3 class="title is-4">FuseChat-Llama-3.2-3B-Instruct Performance</h3>
        <table class="js-sort-table table hidden">
          <tr>
            <td class="js-sort-string"><strong>Benchmarks</strong></td>
            <td class="js-sort-string"><strong>Llama-3.2-3B-Instruct</strong></td>
            <td class="js-sort-string"><strong>FuseChat-Llama-3.2-3B-SFT</strong></td>
            <td class="js-sort-string"><strong>FuseChat-Llama-3.2-3B-Instruct</strong></td>
          </tr>
        
          <tr>
            <td style="white-space: nowrap;">AlpacaEval-2 (LC %)</td>
            <td>21.4</td>
            <td>31.1</td>
            <td><strong>54.0</strong></td>
          </tr>
        
          <tr>
            <td>Arena-Hard (WR %)</td>
            <td>16.6</td>
            <td>21.3</td>
            <td><strong>30.2</strong></td>
          </tr>
        
          <tr>
            <td>MT-Bench</td>
            <td>6.9</td>
            <td>7.3</td>
            <td><strong>7.7</strong></td>
          </tr>
        
          <tr>
            <td>AlignBench v1.1</td>
            <td>3.8</td>
            <td>5.5</td>
            <td><strong>5.9</strong></td>
          </tr>

          <tr>
            <td>GSM8K</td>
            <td>82.0</td>
            <td><strong>82.8</strong></td>
            <td>82.0</td>
          </tr>
        
          <tr>
            <td>MATH</td>
            <td>51.4</td>
            <td>52.9</td>
            <td><strong>53.1</strong></td>
          </tr>
        
          <tr>
            <td>AMC23</td>
            <td>22.5</td>
            <td>20.0</td>
            <td><strong>35.0</strong></td>
          </tr>
        
          <tr>
            <td>LiveBench 0831</td>
            <td>23.4</td>
            <td>24.5</td>
            <td><strong>24.9</strong></td>
          </tr>
                
          <tr>
            <td>MMLU-Pro</td>
            <td>39.3</td>
            <td><strong>40.3</strong></td>
            <td>40.3</td>
          </tr>
        
          <tr>
            <td>MMLU-redux</td>
            <td>58.5</td>
            <td>58.2</td>
            <td><strong>59.0</strong></td>
          </tr>
        
          <tr>
            <td>GPQA-Diamond</td>
            <td>29.8</td>
            <td>33.3</td>
            <td><strong>33.8</strong></td>
          </tr>
        
          <tr>
            <td>HumanEval</td>
            <td>61.0</td>
            <td><strong>62.8</strong></td>
            <td>60.4</td>
          </tr>
        
          <tr>
            <td>MBPP</td>
            <td><strong>68.5</strong></td>
            <td>67.5</td>
            <td>67.5</td>
          </tr>
        
          <tr>
            <td>LiveCodeBench<br>2408-2411</td>
            <td>8.3</td>
            <td>7.1</td>
            <td><strong>9.0</strong></td>
          </tr>
        
          <tr>
            <td>Average</td>
            <td>35.2</td>
            <td>36.8</td>
            <td><strong>40.2</strong></td>
          </tr>
        </table>
        <h3 class="title is-4">FuseChat-Llama-3.2-1B-Instruct Performance</h3>
        <table class="js-sort-table table hidden">
          <tr>
            <td class="js-sort-string"><strong>Benchmarks</strong></td>
            <td class="js-sort-string"><strong>Llama-3.2-1B-Instruct</strong></td>
            <td class="js-sort-string"><strong>FuseChat-Llama-3.2-1B-SFT</strong></td>
            <td class="js-sort-string"><strong>FuseChat-Llama-3.2-1B-Instruct</strong></td>
          </tr>
        
          <tr>
            <td style="white-space: nowrap;">AlpacaEval-2 (LC %)</td>
            <td>9.7</td>
            <td>14.0</td>
            <td><strong>25.3</strong></td>
          </tr>
        
          <tr>
            <td>Arena-Hard (WR %)</td>
            <td>5.1</td>
            <td>6.0</td>
            <td><strong>8.6</strong></td>
          </tr>
        
          <tr>
            <td>MT-Bench</td>
            <td>4.7</td>
            <td>5.2</td>
            <td><strong>5.7</strong></td>
          </tr>
        
          <tr>
            <td>AlignBench v1.1</td>
            <td>2.9</td>
            <td>3.9</td>
            <td><strong>4.3</strong></td>
          </tr>

          <tr>
            <td>GSM8K</td>
            <td>46.3</td>
            <td><strong>55.6</strong></td>
            <td>54.5</td>
          </tr>
        
          <tr>
            <td>MATH</td>
            <td>32.7</td>
            <td><strong>34.7</strong></td>
            <td>33.6</td>
          </tr>
        
          <tr>
            <td>AMC23</td>
            <td>17.5</td>
            <td>15.0</td>
            <td><strong>20.0</strong></td>
          </tr>
          
          <tr>
            <td>LiveBench 0831</td>
            <td>14.0</td>
            <td>13.9</td>
            <td><strong>15.8</strong></td>
          </tr>
              
          <tr>
            <td>MMLU-Pro</td>
            <td><strong>22.3</strong></td>
            <td>21.5</td>
            <td>21.3</td>
          </tr>
        
          <tr>
            <td>MMLU</td>
            <td><strong>45.8</strong></td>
            <td>45.0</td>
            <td>44.8</td>
          </tr>
        
          <tr>
            <td>GPQA-Diamond</td>
            <td>21.2</td>
            <td><strong>25.3</strong></td>
            <td>24.2</td>
          </tr>
        
          <tr>
            <td>HumanEval</td>
            <td>39.6</td>
            <td>36.6</td>
            <td><strong>40.2</strong></td>
          </tr>
        
          <tr>
            <td>MBPP</td>
            <td><strong>49.5</strong></td>
            <td>42.1</td>
            <td>46.6</td>
          </tr>
        
          <tr>
            <td>Average</td>
            <td>24.0</td>
            <td>24.5</td>
            <td><strong>26.5</strong></td>
          </tr>
        </table>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End Evaluation -->

<!-- BibTeX Citation -->
<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@inproceedings{yang2025weightedreward,
  title={Weighted-Reward Preference Optimization for Implicit Model Fusion},
  author={Ziyi Yang and Fanqi Wan and Longguang Zhong and Tianyuan Shi and Xiaojun Quan},
  booktitle={The Thirteenth International Conference on Learning Representations},
  year={2025},
  url={https://openreview.net/forum?id=fq24pEb8SL}
}
}</code></pre>
  </div>
</section>

<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the <a href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
            You are free to borrow the source code of this website, we just ask that you link back to this page in the footer. <br> This website is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
